<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>مدیریت نمونه‌کارها</title>
</head>
<body>
  <h2>مدیریت نمونه‌کارها</h2>
  
  <form id="addProjectForm">
    <label for="projectName">نام پروژه:</label>
    <input type="text" id="projectName" required><br>
    
    <label for="projectImage">لینک تصویر:</label>
    <input type="text" id="projectImage" required><br>

    <label for="projectDescription">توضیحات:</label>
    <textarea id="projectDescription" required></textarea><br>

    <button type="submit">اضافه کردن نمونه‌کار</button>
  </form>

  <h3>نمونه‌کارها</h3>
  <ul id="projectsList">
    <!-- لیست نمونه‌کارها اینجا نمایش داده می‌شود -->
  </ul>

  <script>
    const addProjectForm = document.getElementById("addProjectForm");
    const projectsList = document.getElementById("projectsList");

    // بارگذاری نمونه‌کارها از فایل JSON
    async function loadProjects() {
      const response = await fetch('../data/projects.json');
      const projects = await response.json();
      
      projectsList.innerHTML = "";
      projects.forEach((project, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <h4>${project.name}</h4>
          <img src="${project.image}" alt="${project.name}" width="100">
          <p>${project.description}</p>
          <button onclick="deleteProject(${index})">حذف</button>
        `;
        projectsList.appendChild(li);
      });
    }

    // حذف پروژه
    async function deleteProject(index) {
      const response = await fetch('../data/projects.json');
      const projects = await response.json();
      projects.splice(index, 1);
      await saveProjects(projects);
      loadProjects();
    }

    // ذخیره پروژه‌ها
    async function saveProjects(projects) {
      const response = await fetch('../data/projects.json', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(projects)
      });
    }

    // اضافه کردن پروژه جدید
    addProjectForm.addEventListener("submit", (e) => {
      e.preventDefault();
      
      const newProject = {
        name: document.getElementById("projectName").value,
        image: document.getElementById("projectImage").value,
        description: document.getElementById("projectDescription").value
      };

      fetch('../data/projects.json')
        .then(response => response.json())
        .then((projects) => {
          projects.push(newProject);
          return saveProjects(projects);
        })
        .then(() => {
          loadProjects();
        });
    });

    // بارگذاری اولیه نمونه‌کارها
    loadProjects();
  </script>
</body>
</html>
